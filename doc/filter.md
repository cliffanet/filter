# Анализатор работы фильтра измеряемых параметров

Все фильтры приведены к общему принципу:

* Параметры, указываемые при инициализации (обычно их можно поменять в процессе).

* При каждом замере вызываем метод tick(val, tdiff), где:

    * val - текущее измеренное значение
    
    * tdiff - целое, означающее время, прошедшее с предыдущего замера

* На выходе фильтра параметры, получаемые методами:

    * value() - отфильтрованное значение
    
    * speed() - текущая скорость изменения (в тех же единицах, в которых указаны значение и время)

## Среднее арифметическое

* Модуль: filter_avg.h

* Имя класса (шаблона): FilterAvg

* Параметры:

    * `size` - количество хранимых значений (более новые вытесняют самые старые).

* Пример:

```cpp
    FilterAvg <double> filter(20);
    
    void loop() {
        static auto m = 0;
        auto m1 = millis();
        
        double val = measure();
        
        val = filter.tick(val, m1-m);
        m = m1;
    }
```

![](doc/filteravg.png)

value() = (val1 + val2 + ... + valn) / size

speed() = (val1 - valn) / (tdiff2 + tdiff3 + ... + tdiffn)

Опоздание отфильтрованного значения от истинного: Половина хранимого времени

## Среднее квадратическое

* Модуль: filter_avg2.h

* Имя класса (шаблона): FilterAvg2


## Метод наименьших квадратов

* Модуль: filter_ltsqrt.h

* Имя класса (шаблона): FilterLtSqrt


## Максимальное ускорение

* Модуль: filter_maxaccel.h

* Имя класса (шаблона): FilterMaxAccel


## Фильтр Калмана

* Модуль: filter_kalman.h

* Имя класса (шаблона): FilterKalman


## Среднее арифметическое круглых чисел

* Модуль: filter_avgdeg.h

* Имя класса (шаблона): FilterAvgDeg

Этоn фильтр применяется только для круглых чисел (например: угол отклонения компаса, нафигационное направление движения в градусах и т.п.),
и отсутствует в симуляторе.


